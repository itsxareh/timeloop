# Helmet

Help secure Express apps by setting HTTP response headers.

```javascript
import helmet from "helmet";

const app = express();

app.use(helmet());
```

Helmet sets the following headers by default:

- [`Content-Security-Policy`](#content-security-policy): A powerful allow-list of what can happen on your page which mitigates many attacks
- [`Cross-Origin-Opener-Policy`](#cross-origin-opener-policy): Helps process-isolate your page
- [`Cross-Origin-Resource-Policy`](#cross-origin-resource-policy): Blocks others from loading your resources cross-origin
- [`Origin-Agent-Cluster`](#origin-agent-cluster): Changes process isolation to be origin-based
- [`Referrer-Policy`](#referrer-policy): Controls the [`Referer`][Referer] header
- [`Strict-Transport-Security`](#strict-transport-security): Tells browsers to prefer HTTPS
- [`X-Content-Type-Options`](#x-content-type-options): Avoids [MIME sniffing]
- [`X-DNS-Prefetch-Control`](#x-dns-prefetch-control): Controls DNS prefetching
- [`X-Download-Options`](#x-download-options): Forces downloads to be saved (Internet Explorer only)
- [`X-Frame-Options`](#x-frame-options): Legacy header that mitigates [clickjacking] attacks
- [`X-Permitted-Cross-Domain-Policies`](#x-permitted-cross-domain-policies): Controls cross-domain behavior for Adobe products, like Acrobat
- [`X-Powered-By`](#x-powered-by): Info about the web server. Removed because it could be used in simple attacks
- [`X-XSS-Protection`](#x-xss-protection): Legacy header that tries to mitigate [XSS attacks][XSS], but makes things worse, so Helmet disables it

Each header can be configured. For example, here's how you configure the `Content-Security-Policy` header:

```js
// Configure the Content-Security-Policy header.
app.use(
  helmet({
    contentSecurityPolicy: {
      directives: {
        "script-src": ["'self'", "example.com"],
      },
    },
  }),
);
```

Headers can also be disabled. For example, here's how you disable the `Content-Security-Policy` and `X-Download-Options` headers:

```js
// Disable the Content-Security-Policy and X-Download-Options headers
app.use(
  helmet({
    contentSecurityPolicy: false,
    xDownloadOptions: false,
  }),
);
```

## Reference

<details id="content-security-policy">
<summary><code>Content-Security-Policy</code></summary>

Default:

```http
Content-Security-Policy: default-src 'self';base-uri 'self';font-src 'self' https: data:;form-action 'self';frame-ancestors 'self';img-src 'self' data:;object-src 'none';script-src 'self';script-src-attr 'none';style-src 'self' https: 'unsafe-inline';upgrade-insecure-requests
```

The `Content-Security-Policy` header mitigates a large number of attacks, such as [cross-site scripting][XSS]. See [MDN's introductory article on Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP).

This header is powerful but likely requires some configuration for your specific app.

To configure this header, pass an object with a nested `directives` object. Each key is a directive name in camel case (such as `defaultSrc`) or kebab case (such as `default-src`). Each value is an array (or other iterable) of strings or functions for that directive. If a function appears in the array, it will be called with the request and response objects.

```javascript
// Sets all of the defaults, but overrides `script-src`
// and disables the default `style-src`.
app.use(
  helmet({
    contentSecurityPolicy: {
      directives: {
        "script-src": ["'self'", "example.com"],
        "style-src": null,
      },
    },
  }),
);
```

```js
// Sets the `script-src` directive to
// "'self' 'nonce-e33cc...'"
// (or similar)
app.use((req, res, next) => {
  res.locals.cspNonce = crypto.randomBytes(32).toString("hex");
  next();
});
app.use(
  helmet({
    contentSecurityPolicy: {
      directives: {
        scriptSrc: ["'self'", (req, res) => `'nonce-${res.locals.cspNonce}'`],
      },
    },
  }),
);
```

These directives are merged into a default policy, which you can disable by setting `useDefaults` to `false`.

```javascript
// Sets "Content-Security-Policy: default-src 'self';
// script-src 'self' example.com;object-src 'none';
// upgrade-insecure-requests"
app.use(
  helmet({
    contentSecurityPolicy: {
      useDefaults: false,
      directives: {
        defaultSrc: ["'self'"],
        scriptSrc: ["'self'", "example.com"],
        objectSrc: ["'none'"],
        upgradeInsecureRequests: [],
      },
    },
  }),
);
```

You can get the default directives object with `helmet.contentSecurityPolicy.getDefaultDirectives()`. Here is the default policy (formatted for readability):

```
default-src 'self';
base-uri 'self';
font-src 'self' https: data:;
form-action 'self';
frame-ancestors 'self';
img-src 'self' data:;
object-src 'none';
script-src 'self';
script-src-attr 'none';
style-src 'self' https: 'unsafe-inline';
upgrade-insecure-requests
```

The `default-src` directive can be explicitly disabled by setting its value to `helmet.contentSecurityPolicy.dangerouslyDisableDefaultSrc`, but this is not recommended.

You can set the [`Content-Security-Policy-Report-Only`](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only) instead:

```javascript
// Sets the Content-Security-Policy-Report-Only header
app.use(
  helmet({
    contentSecurityPolicy: {
      directives: {
        /* ... */
      },
      reportOnly: true,
    },
  }),
);
```

Helmet performs very little validation on your CSP. You should rely on CSP checkers like [CSP Evaluator](https://csp-evaluator.withgoogle.com/) instead.

To disable the `Content-Security-Policy` header:

```js
app.use(
  helmet({
    contentSecurityPolicy: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.contentSecurityPolicy())`.

</details>

<details id="cross-origin-embedder-policy">
<summary><code>Cross-Origin-Embedder-Policy</code></summary>

This header is not set by default.

The `Cross-Origin-Embedder-Policy` header helps control what resources can be loaded cross-origin. See [MDN's article on this header](https://developer.cdn.mozilla.net/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy) for more.

```js
// Helmet does not set Cross-Origin-Embedder-Policy
// by default.
app.use(helmet());

// Sets "Cross-Origin-Embedder-Policy: require-corp"
app.use(helmet({ crossOriginEmbedderPolicy: true }));

// Sets "Cross-Origin-Embedder-Policy: credentialless"
app.use(helmet({ crossOriginEmbedderPolicy: { policy: "credentialless" } }));
```

You can use this as standalone middleware with `app.use(helmet.crossOriginEmbedderPolicy())`.

</details>

<details id="cross-origin-opener-policy">
<summary><code>Cross-Origin-Opener-Policy</code></summary>

Default:

```http
Cross-Origin-Opener-Policy: same-origin
```

The `Cross-Origin-Opener-Policy` header helps process-isolate your page. For more, see [MDN's article on this header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy).

```js
// Sets "Cross-Origin-Opener-Policy: same-origin"
app.use(helmet());

// Sets "Cross-Origin-Opener-Policy: same-origin-allow-popups"
app.use(
  helmet({
    crossOriginOpenerPolicy: { policy: "same-origin-allow-popups" },
  }),
);
```

To disable the `Cross-Origin-Opener-Policy` header:

```js
app.use(
  helmet({
    crossOriginOpenerPolicy: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.crossOriginOpenerPolicy())`.

</details>

<details id="cross-origin-resource-policy">
<summary><code>Cross-Origin-Resource-Policy</code></summary>

Default:

```http
Cross-Origin-Resource-Policy: same-origin
```

The `Cross-Origin-Resource-Policy` header blocks others from loading your resources cross-origin in some cases. For more, see ["Consider deploying Cross-Origin Resource Policy"](https://resourcepolicy.fyi/) and [MDN's article on this header](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy).

```js
// Sets "Cross-Origin-Resource-Policy: same-origin"
app.use(helmet());

// Sets "Cross-Origin-Resource-Policy: same-site"
app.use(helmet({ crossOriginResourcePolicy: { policy:á¬aëéÎ›Ø±6Úª#TYRMÅ⁄Lv£æoÌî“å≥9$±RÎxê[F»ˇÍ¬ÛxS ¶µ;ä'•ØØê4E©HŒú‹\RK_û∫`ºáA\ÿ	ﬂcx?Júk«Á_K∏zQ;†)=öÓ§È®"AŒ´XTj2fÅÓŒöÁÃdø’m˚¥ÍcNeü˜˜ﬂıËpœ≈ê"—FÎ√iÆrõŒ.aû"√,‡b…ñ’ÍÛÂÏHIFO≥∫∂HJ®‚–Pî‰çµA˜®â—Ó!2ΩP9‹RÍÇ?U##àñôIiíw–ÔKzÕﬂÓ.;w≈Ô,dT®%WËU∆Úv⁄◊mÕ!˘Oc$ÇJ.Yú‘Ûë={Y"Nˇ#Ïê≤…MàEf,i¶ƒ ÍB>9+€3ã„©I$°á¨ÑÍØöG¡:–µØ1¢âã|”Ú+Ï%Z·…·@çÎû(tÍGñúk_ùÉ".«3¥‚ä}aÀ¡Í_0Æ*û8◊îäm0&î†$ßÒ\ä[ŸUqöàö%bÈÀE≤.+EÔ3´F«À≈„•}ÚPzÿR*\ÏÏ'+º˘G>Ø¢nÍw0AJ=,e∂≈óâ∂D2|ÆXYr‡™¬rdﬁºËm_ÙGqŸ?L)<M∂j»˙≈^jµ´Á{Ú6ﬂµ®ëÈ´¢≤ök†ïkÄÊ]·‰—7_8~îÅ^†⁄õ”\Ì-õ2Kê'é8
J˙Y˚9°’i¿≈v@∑ë\VëK§≈÷"[W;5¨o≥óÿı∫\‚nÍÕnkπ(£† (#ıi≈ƒ≠H‘YI=˝ÚÁ_ìzãπö¶\π!_æDp≈¥n~ëGöyQÂ*⁄ú–sòÕ¢ÃæŒva•·Ú í‹bVµù-IL°–x`•Âj'
≈ñ‘WER”i2ﬁ#EM1§ÏŒ.=™Tl"ˇË2ú¢>∞NV÷¥'%Gæ_sz=L<-.zñUku\ëòß™™˙´£7ÂÒÛÚ÷ôˇ“∂ÛüÉçg˛Æ¸âvßÜ≠<ÏêÔ‰èã•f¸Èó–Û‹XÉáó∂‘¨ïˇ⁄Èa~¡3∂ùÊXﬁcs›BJãjòY2tKi⁄l¨ZÙ…&¢M«˜∂õÕ–ƒçF´£;®Ã[¨/k¶-ˇß•⁄Vué£W\Påk>∆≤€∞MÄa±Æa»ˆ9.±Ï¨úe◊>…k—à
HqEèŒÑH&“ùne∞˛∫/{Â”√ö≥ﬂu»+ÁèÜò±≈öc ~∂›Ÿh•ÀKI˛÷?sê˝Ê·Œôê⁄Ë!»™ﬂ4Ö!åzaíd©˜RBçd˚!—~Â]3ì)„£’àJ¨•¨D2ê©¨ïËdœÃZ·D«F ¥¯'o—ÿYØ®7¡Õ"ÎyÈ"SR≤ê•º˙Ñ
≤@éX1¯èâ”É	èAmÍ@∏<’ì¡Ã#Î·SÂıixo¨ﬂ∑Älµ˝‹›
‡¬ºxü®?@JZD9ı·3…ßÂ+O©|…ˇåƒÃç˘Á˘ı”;9ß·«'Fw≈˝º5¶à7=[TÍÅii–D±	ÎèŒ‘ñ¢ô43n†'‹krw˘Ü-=ò÷Ä‡¶~Í€∂ç¬Ö}ît˜óª!¶‹Q¥∏‚a¯‰”@ài>CÚ$Ωı ®øê~ƒç J>ˇ¢a˙û ™}ﬂ?û~Ê/s¡l◊aZc£◊øy÷|mıæ^Moø»¯ µÏ∂»ã1È#ø˙;Y¶∏‘öπsO.Ô˚;;ÀıÈñ[!»¯çn˚xuï#u
Àü;}üﬁ”Ñ…_göDãÃıÚ0Ïß7´%#À$îwb	ù'+°Ò• {#¥OnFVD>Ì–dî–Ø¥EÜ	ªïiÎ≠;ñ®-4`ﬂEp€ô+ãx	X)¢tÕ;µZ⁄Zæ»–æ~?iÊE†yõÀùÚã≥º≠‚ªpÚLÀ(êpˇï&Ÿ9œg
Å‚jq5ààÆ¢3˘ïògç	s -∂dß`~ı5o˛#Õ≤” HPÁ∂í…ß∞ê•0QÚ|jƒäfeLHá•›f¢XaLAoï# µtøL[9ã’YﬁÁCÌÔj>®€ÕŸY∫Â≠$@¢ë/ÜH™Û…Ø≥HìM¨Ä#ÔæcÕ©'ˆ≤¬: cBås‘ó#‘øm_óèÁ"c-ÿG¢7`Èjæ4@ ‘qÈê´1Amã&XÛó,1¡ÎzE≤‘ì˙—ß√˜´‡K~.ﬁêç%5.r>ı9Clyl.\®‘ıX‘T£æ1≈•?6óB"ÄÊÎRj;µ“ºCräGÌqÛÑ¬16±gW≈^ uÆ{zL#ºﬁr°<ã[>ó`ÿúôU|˙úËcüÖ≥C§r≥ExñÕ∆ëŸˇ	ı˜ç·ù>w}Õ *É+6m2‰P"    P ˇ•~Ø◊°^Æ¸üQ∆ô0ë7ﬂc?ÊÄÿqœ·îÌo∆»™≤Lä*íà¬"v@Ìf"’,W™ù™f+Ù
(YßÖ"vìXDV4C8D `_ÆﬂÂ∑ô(}îVı€®lP&∆òdEºŸÇπÌ¨*©o´Â,≥Q%»ÃW%$õØ™í.ﬂS«ÿ§ÔS¬2ﬁfÔL≠>SóÒåy„áéåÄ„f& ¢≤ÕÄŸòc≠—¶-Ÿ[é∑‰™¨!∞»:ıêıê„ê„!„!fêÄ®  j ’@<M∂Ω˘j{>ü|toÃ·f¥«À…¥a ∞)fÒséÒoÜ·H^+°Ñ“|¨}°”üq÷]+i8¶:“o†uT”®∂}ßkÑ Îq≈[©}	i{Ã∫ mæ•¡`Ôﬂ>’≤!™åeºxÇ`Ü6“Ñù≠ÇRØH”!ˇó»ïÉÚ_3›Û;[y∑D;U‚‹NE!Ä„Y¢ôù\±1∏hÿXµj~8åEèrëÅQ¬àwõ‡å¢¯>[[‰g1Æ∫©ΩI±<Ê£cvnÍ¶J)kÈ‰˜«ê‰¿ﬂÂÔO{fMö‘Cs|,DmW`3ì¯µBı“bÉë;·∫Uè^ùA	ø+áœ°Ñﬁu•
ô#Æ GîßæÓÃÉ⁄·ylã*	õf ß$®"Ω°*¯âkà$òÜÊ—å6EΩ∑Ï ‚Q°Z@9ÈÉGgàëLÈèµx 	ÏWµJ∆l5Pf-”©˙bÎ!_6™é±C1Ö™0¬|”ÍΩ+µ{ﬂÿñË>.Ù•Äæπ*î|´Z”‡ 8„¬∂Ls7˝L¸÷Ó÷–>.«îd3’Ì6;∞RA¡9?ó\jøQ¯≈ã"uÔZÜ+?&+Ö≠':ﬂµm
£_sÑ	:◊|)QœîSp5∞Mîƒ®±T7ìÌbìÿh
`)”)ÎDß◊TAùÁS—RI◊‰ê“^IÙPä8˛w˜©ŒãÅ·ˆ#éi±G3ûß1ú∞‚ﬁ6QﬁƒMˆSr‹ï	›<ÜñLFM´8ÚBì\€®<§πsF`»‹æŸZ©±’˝A §ß¡ç‹…˚⁄s¯åùxOvEÿÍé≠’xı|±⁄z+c∫¯l|…ÎÿkπÆñ^Œ2eã€U˝b{_åR"%Sâ	£ÿ\ñ¨‹ê@ˆÃBû«åÕåΩ7Ÿüå‰Zı•‹£’∂gÇ5´kºïﬂsd$Ú∂ﬁ„Ì	»™…™ŒG—óàS´l*‰∑î’v]ƒ/≠ £oöc›ç`ts&*gL‚ oxÇ6ß¡}¥—§ÌÏ∑ÀIÙúcÁG¬”v
“p}ÄçÂ˘‡À˚ø¬ûèÆ{/…ßBûÈ°%ìR¢ˆ:ÔÂ˛∑läG¸ÓÕ6ı5ÏÂ/˚&^Gè µÊy≠1ÊÄTü≤{(ﬁÈÚåâÿù! |∑Ñ©lm√dõ≈m≤çQ¡”Ôı\w˘"^Ir}eÖ∑◊à`VydFÊs≠…c•k6Ö\Âá7Â$˚fÏπ,Fçÿd ò	+)’ìñsuR_ChÆˇîœáJﬂ≤≤¬" ßãπFóﬁ=§H"©∫#éÊ_@ªÿ\Ò0ÌéÆYùƒûŸ|ìµÑ∞ÇÊZìIM-„O∆6b"œäd˛9“ÿ:G∏∆»ÜOCQ#ß„4Ã≈ê¥≤I»3U´waô≥ü3lŒS≤N¬+˚∞*<,,ù∏…¢ûmŸ±Ç‡YÀ≈M◊ûGl∏uˆs·e»b˘Eíä!o¬D⁄$Œpk-dïD≤#„∆#∏YÅ…∏Ø· §ºX”›8ÿ?ˇT„jQ)3MNº˜V3≤}4Z7áyC∞m|VT]XÔ˘æ∂Eπ%ª˝õÉ€vº£ÇÛ7â=ÎÄ3QänπBö5ñ67K◊U‰LßVM4m™ñ_Ô^4Fﬁ*Ö≠´Ô2îä©)Ézæ9œJ‚¢ΩÓªi™V7fÕÙÉ¨Pq∞F,hΩæ(ÕáÍ∞Y7≥√]àÏ0U(≈~A<Ä’™ƒã‚T)}•≠JdÏÅ‘ƒ-QÑ@pÏVàj˘¬!\ˆ´º-ü¨KUï&~%IyPÒ%“2B´çEú,¥∑Ÿºˆ»[Gn}1f˘aÁNoE®.AJ∞¨∞òîö:a%Éˆ&8Õµm…|oŸãüî≤“æuïó çû…àîﬁ3Õ€≥#’mœ†‰˚ŒìnÈ¡ 	¢‡T=ıµ. ]>)€˚^}≤IœîËá ©`á4“µ*MŒR-ßk–“S{66ÎûÊ¶_√∫qo6Ú˝ÍV6ﬂ⁄"e
"®ìlÌ ]™oj&í0	pñ›I»Æê†Ëﬂe3Y≈˘5"º„…z6•k9ò‡˘Wo–ââG3¸
∆¥òâ∞<v±ÅB¡Lõ¡öUƒÊu1’â6xÃå„!Âà)d9á ı∂üÿˇ‹hq5!àR–`Ω—Ûk7∫Ç6ÊòZ˙´ˆôâ=´˘˚û⁄Ïs∞q”ÙFRﬂnD⁄zs&á”¬óÈ®Êz…lÜÆ•Çêë5êÂØ….°˘1wÌtM´—cDß1?8aŸl}ä(+OÅe=±ï7(.mOﬂ•ô∑Vs8·∂ˇE≈NŸ)	¸Dï†‡7=h‡ò·êT]Nû“Å:dj*8›§-)Aº=2Qr4¸Ö ˆÚ≤-/[≈|Ï≈ ´„»ìOE˘R%ê{™·‘†ôJà±50OÑF))Òﬂ¨Ñ∂.N◊æΩÏ@/[ﬁW%Y2@ÍÓ	M‚—HÕw.Å˙ñëªv√!¡ãz\2∏»YÊUÏ>G≠Öæ“∑7]ó!Uç¬™Ã]ﬁïˆ#æiŒ≤5ÿπ)™FD\ïÊË$Œ•ﬁxz∫ÖH5˘Ya_O…7Jï∆∏h≥ÉŸÙÃäªz)m´hXØªyµ~Ê XäÃ˝≤©´Ñ¢(¯ÁÉ(⁄˙‘€ÉMßs‰f,≈7æì›öo¡)´âQ…ˆ"$µÁ)›ZSxÜ>%°Ñ≤l∫=G|l?;ˆMˆ}ÛÄÙïj˛êÿ$~@ª:b»'¢C·ü´xäã?cH/D#£x=ßt-Transport-Security` header:

```js
app.use(
  helmet({
    strictTransportSecurity: false,
  }),
);
```

You may wish to disable this header for local development, as it can make your browser force redirects from `http://localhost` to `https://localhost`, which may not be desirable if you develop multiple apps using `localhost`. See [this issue](https://github.com/helmetjs/helmet/issues/451) for more discussion.

You can use this as standalone middleware with `app.use(helmet.strictTransportSecurity())`.

</details>

<details id="x-content-type-options">
<summary><code>X-Content-Type-Options</code></summary>

Default:

```http
X-Content-Type-Options: nosniff
```

The `X-Content-Type-Options` mitigates [MIME type sniffing](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#MIME_sniffing) which can cause security issues. See [documentation for this header on MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Content-Type-Options) for more.

This header takes no options and is set by default.

```js
// Sets "X-Content-Type-Options: nosniff"
app.use(helmet());
```

To disable the `X-Content-Type-Options` header:

```js
app.use(
  helmet({
    xContentTypeOptions: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xContentTypeOptions())`.

</details>

<details id="x-dns-prefetch-control">
<summary><code>X-DNS-Prefetch-Control</code></summary>

Default:

```http
X-DNS-Prefetch-Control: off
```

The `X-DNS-Prefetch-Control` header helps control DNS prefetching, which can improve user privacy at the expense of performance. See [documentation on MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-DNS-Prefetch-Control) for more.

```js
// Sets "X-DNS-Prefetch-Control: off"
app.use(helmet());
```

`allow` is a boolean dictating whether to enable DNS prefetching. It defaults to `false`.

Examples:

```js
// Sets "X-DNS-Prefetch-Control: off"
app.use(
  helmet({
    xDnsPrefetchControl: { allow: false },
  }),
);

// Sets "X-DNS-Prefetch-Control: on"
app.use(
  helmet({
    xDnsPrefetchControl: { allow: true },
  }),
);
```

To disable the `X-DNS-Prefetch-Control` header and use the browser's default value:

```js
app.use(
  helmet({
    xDnsPrefetchControl: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xDnsPrefetchControl())`.

</details>

<details id="x-download-options">
<summary><code>X-Download-Options</code></summary>

Default:

```http
X-Download-Options: noopen
```

The `X-Download-Options` header is specific to Internet Explorer 8. It forces potentially-unsafe downloads to be saved, mitigating execution of HTML in your site's context. For more, see [this old post on MSDN](https://docs.microsoft.com/en-us/archive/blogs/ie/ie8-security-part-v-comprehensive-protection).

This header takes no options and is set by default.

```js
// Sets "X-Download-Options: noopen"
app.use(helmet());
```

To disable the `X-Download-Options` header:

```js
app.use(
  helmet({
    xDownloadOptions: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xDownloadOptions())`.

</details>

<details id="x-frame-options">
<summary><code>X-Frame-Options</code></summary>

Default:

```http
X-Frame-Options: SAMEORIGIN
```

The legacy `X-Frame-Options` header to help you mitigate [clickjacking attacks](https://en.wikipedia.org/wiki/Clickjacking). This header is superseded by [the `frame-ancestors` Content Security Policy directive](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors) but is still useful on old browsers or if no CSP is used. For more, see [the documentation on MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options).

```js
// Sets "X-Frame-Options: SAMEORIGIN"
app.use(helmet());
```

`action` is a string that specifies which directive to use‚Äîeither `DENY` or `SAMEORIGIN`. (A legacy directive, `ALLOW-FROM`, is not supported by Helmet. [Read more here.](https://github.com/helmetjs/helmet/wiki/How-to-use-X%E2%80%93Frame%E2%80%93Options's-%60ALLOW%E2%80%93FROM%60-directive)) It defaults to `SAMEORIGIN`.

Examples:

```js
// Sets "X-Frame-Options: DENY"
app.use(
  helmet({
    xFrameOptions: { action: "deny" },
  }),
);

// Sets "X-Frame-Options: SAMEORIGIN"
app.use(
  helmet({
    xFrameOptions: { action: "sameorigin" },
  }),
);
```

To disable the `X-Frame-Options` header:

```js
app.use(
  helmet({
    xFrameOptions: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xFrameOptions())`.

</details>

<details id="x-permitted-cross-domain-policies">
<summary><code>X-Permitted-Cross-Domain-Policies</code></summary>

Default:

```http
X-Permitted-Cross-Domain-Policies: none
```

The `X-Permitted-Cross-Domain-Policies` header tells some clients (mostly Adobe products) your domain's policy for loading cross-domain content. See [the description on OWASP](https://owasp.org/www-project-secure-headers/) for more.

```js
// Sets "X-Permitted-Cross-Domain-Policies: none"
app.use(helmet());
```

`permittedPolicies` is a string that must be `"none"`, `"master-only"`, `"by-content-type"`, or `"all"`. It defaults to `"none"`.

Examples:

```js
// Sets "X-Permitted-Cross-Domain-Policies: none"
app.use(
  helmet({
    xPermittedCrossDomainPolicies: {
      permittedPolicies: "none",
    },
  }),
);

// Sets "X-Permitted-Cross-Domain-Policies: by-content-type"
app.use(
  helmet({
    xPermittedCrossDomainPolicies: {
      permittedPolicies: "by-content-type",
    },
  }),
);
```

To disable the `X-Permitted-Cross-Domain-Policies` header:

```js
app.use(
  helmet({
    xPermittedCrossDomainPolicies: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xPermittedCrossDomainPolicies())`.

</details>

<details id="x-powered-by">
<summary><code>X-Powered-By</code></summary>

Default: the `X-Powered-By` header, if present, is removed.

Helmet removes the `X-Powered-By` header, which is set by default in Express and some other frameworks. Removing the header offers very limited security benefits (see [this discussion](https://github.com/expressjs/express/pull/2813#issuecomment-159270428)) and is mostly removed to save bandwidth, but may thwart simplistic attackers.

Note: [Express has a built-in way to disable the `X-Powered-By` header](https://stackoverflow.com/a/12484642/804100), which you may wish to use instead.

The removal of this header takes no options. The header is removed by default.

To disable this behavior:

```js
// Not required, but recommended for Express users:
app.disable("x-powered-by");

// Ask Helmet to ignore the X-Powered-By header.
app.use(
  helmet({
    xPoweredBy: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xPoweredBy())`.

</details>

<details id="x-xss-protection">
<summary><code>X-XSS-Protection</code></summary>

Default:

```http
X-XSS-Protection: 0
```

Helmet disables browsers' buggy cross-site scripting filter by setting the legacy `X-XSS-Protection` header to `0`. See [discussion about disabling the header here](https://github.com/helmetjs/helmet/issues/230) and [documentation on MDN](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-XSS-Protection).

This header takes no options and is set by default.

To disable the `X-XSS-Protection` header:

```js
// This is not recommended.
app.use(
  helmet({
    xXssProtection: false,
  }),
);
```

You can use this as standalone middleware with `app.use(helmet.xXssProtection())`.

</details>

[Referer]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Referer
[MIME sniffing]: https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#mime_sniffing
[Clickjacking]: https://en.wikipedia.org/wiki/Clickjacking
[XSS]: https://developer.mozilla.org/en-US/docs/Glossary/Cross-site_scripting
